(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{49924:function(n,e,t){"use strict";var r=t(88814),o=t.n(r),c=t(8418),i=t(66101),s=t(20194),u=t(48557),a=t(77172),f=t(92463),l=t(10128),h=t(48355),v=t(14730),d=t(61150);function w(n,e,t,r,o,c,i){try{var s=n[c](i),u=s.value}catch(a){return void t(a)}s.done?e(u):Promise.resolve(u).then(r,o)}var g="test",m="cn-northwest-1",p="amazonaws.com.cn",y="zmo-webservice-".concat(g),b="zmo-lambda-".concat(g),P="resize",S="https://".concat(y,".s3.").concat(m,".").concat(p),C=function(){function n(){var e=this;!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.authInfo={credentials:{accessKeyId:"string",expiration:0,secretAccessKey:"string",sessionToken:"string"},path:"string",previewTempPath:"string"},this.s3Client=null,this.s3RequestPresigner=null,this.getCredentials=function(){var n=e,t=e.authInfo.credentials.expiration;return(new Date).getTime()<=t?Promise.resolve(e.authInfo):new Promise((function(e,t){var r=n;u.Z.post("/openApi/getAwsSTSForDemo").then((function(n){r.authInfo=n.data,e(n.data)})).catch((function(n){t(n)}))}))}}var e=n.prototype;return e.getS3Client=function(){var n=this;return this.s3Client?Promise.resolve(this.s3Client):new Promise((function(e,t){n.getCredentials().then((function(n){var t=n.credentials,r=t.accessKeyId,o=t.secretAccessKey,i=t.sessionToken;e(new c.g({region:m,credentials:{accessKeyId:r,secretAccessKey:o,sessionToken:i}}))})).catch(t)}))},e.getS3RequestPresigner=function(){var n=this;return this.s3RequestPresigner?Promise.resolve(this.s3RequestPresigner):new Promise((function(e,t){n.getCredentials().then((function(n){var t=n.credentials,r=t.accessKeyId,o=t.secretAccessKey,c=t.sessionToken,i=t.expiration,s=new a.X({credentials:{accessKeyId:r,secretAccessKey:o,sessionToken:c,expiration:new Date(i)},region:m,sha256:h.Sha256});e(s)})).catch(console.error)}))},e.getImgURL=function(n){var e=this;return new Promise((function(t,r){e.getS3Client().then((function(e){var r={Bucket:y,Key:"".concat(null===n||void 0===n?void 0:n.slice(S.length))};e.send(new i.i(r)).then((function(n){var e=n.Body.getReader();return new ReadableStream({start:function(n){return function t(){return e.read().then((function(e){var r=e.done,o=e.value;if(!r)return n.enqueue(o),t();n.close()}))}()}})})).then((function(n){return new Response(n)})).then((function(n){return n.blob()})).then((function(n){return URL.createObjectURL(n)})).then((function(n){return t(n)})).catch((function(){return t("")}))}))}))},e.uploadAws=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this;return new Promise((function(c,i){var u=o;o.getS3Client().then((function(o){var a=u,f=t||e.name,l={Bucket:r?b:y,Key:"".concat(n,"/").concat(f),Body:e};o.send(new s.w(l)).then((function(e){var t="".concat(r?n.slice(P.length+1):n,"/").concat(f),o=S+"/"+t;a.getSignedUrl(t).then((function(n){c({isSuccess:e.$metadata.httpStatusCode===d.m7,presignedURL:n,originURL:o})})).catch(i)})).catch(i)}))}))},e.getSignedUrl=function(n){var e=this;return n.includes(p)&&(n=n.split(p+"/")[1]),new Promise((function(t,r){e.getS3RequestPresigner().then(function(){var e,c=(e=o().mark((function e(c){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=(0,l.e)("".concat(S,"/").concat(n)),c.presign(new f.aW(i),{expiresIn:3600}).then((function(n){t((0,v.C)(n))})).catch(r);case 2:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,o){var c=e.apply(n,t);function i(n){w(c,r,o,i,s,"next",n)}function s(n){w(c,r,o,i,s,"throw",n)}i(void 0)}))});return function(n){return c.apply(this,arguments)}}()).catch(r)}))},n}(),R=new C;e.Z=R},19424:function(n,e,t){"use strict";t.d(e,{GN:function(){return s},Kt:function(){return v},Kx:function(){return f},d9:function(){return u},dO:function(){return a},hv:function(){return l},po:function(){return h},v9:function(){return d}});t(88814);var r=t(59496),o=t(16821),c=t.n(o);function i(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e){var t=document.createElement("a");t.href=n,t.download=e,t.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((function(){t.remove()}),100)}function u(n){var e=(0,r.useState)(new Image)[0],t=(0,r.useState)(!1),o=t[0],c=t[1];return(0,r.useEffect)((function(){return e.onload=function(){c(!0)},c(!1),e.src=URL.createObjectURL(n),function(){e.onload=null}}),[n,e]),[e,o]}function a(n){return 2===n.nativeEvent.button}function f(n){return 1===n.nativeEvent.button}var l=function(n,e){return new Promise((function(t,r){new(c())(n,function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),r.forEach((function(e){i(n,e,t[e])}))}return n}({},e,{success:function(e){t(new File([e],n.name))},error:function(n){console.log(n.message),r(n)}}))}))};function h(n,e){return new Promise((function(t,r){var o=n.src,c=n;c.onload=t,c.onerror=function(n){c.src=o,r(n)},c.src=e}))}var v=function(n){return new Promise((function(e,t){var r=new Image;r.crossOrigin="anonymous",r.src=n,r.onload=function(){return e(r)},r.onerror=t,r.onabort=t}))},d=function(n){for(var e=n.split(","),t=atob(e[1]),r=e[0].match(/:(.*?);/)[1],o=t.length,c=new Uint8Array(o);o--;)c[o]=t.charCodeAt(o);var i=new Blob([c],{type:r});return new File([i],"AnyNameWillBeFine")}},62490:function(){}}]);